
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4. Système conservatif : Effets non linéaires. &#8212; Capacités numériques - Corrigés</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.c441f2ba0852f4cabcb80105e3a46ae6.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="canonical" href="https://pcsi3physiquestan.github.io/capacite_numerique_c/meca_non_lineaire_correction.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5. Etude d’un pendule simple" href="meca_pendule_correction.html" />
    <link rel="prev" title="3. Etude numérique d’un filtre linéaire" href="elec_filtrage_correction.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://pcsi3physiquestan.github.io/capacite_numerique_c/meca_non_lineaire_correction.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Système conservatif : Effets non linéaires." />
<meta property="og:description" content="Système conservatif : Effets non linéaires.  But :  résoudre numériquement une équation différentielle du deuxième ordre non-linéaire et faire apparaître l’effe" />


<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">Capacités numériques - Corrigés</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="capacite_numerique_c.html">
   Capacités numériques en physique
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="signal_fourier_correction.html">
   1. Analyse spectrale d’un signal
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="elec_reponse_o1_correction.html">
   2. Résolution numérique d’une équation différentielle d’ordre 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="elec_filtrage_correction.html">
   3. Etude numérique d’un filtre linéaire
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4. Système conservatif : Effets non linéaires.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="meca_pendule_correction.html">
   5. Etude d’un pendule simple
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="meca_force_centrale_correction.html">
   6. Etude d’un mouvement à force centrale
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="thermo_statique_correction.html">
   7. Etude de l’atmosphère terrestre
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <a href="https://www.cedriclacpatia.fr">Site de la classe</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/meca_non_lineaire_correction.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/meca_non_lineaire_correction.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/meca_non_lineaire_correction.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#position-du-probleme">
   4.1. Position du problème
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#etude-de-l-energie-potentielle">
     4.1.1. Etude de l’énergie potentielle.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#schema-d-euler-pour-un-equation-d-ordre-2">
   4.2. Schéma d’Euler pour un équation d’ordre 2
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#application-a-l-etude-de-la-vibration">
   4.3. Application à l’étude de la vibration
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effets-de-non-linearite">
     4.3.1. Effets de non linéarité
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fonctions-de-la-bibliotheque-scipy">
     4.3.2. Fonctions de la bibliothéque scipy
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="systeme-conservatif-effets-non-lineaires">
<h1><span class="section-number">4. </span>Système conservatif : Effets non linéaires.<a class="headerlink" href="#systeme-conservatif-effets-non-lineaires" title="Permalink to this headline">¶</a></h1>
<p><strong>But :</strong>  résoudre numériquement une équation différentielle du deuxième ordre non-linéaire et faire apparaître l’effet des termes non-linéaires.</p>
<div class="section" id="position-du-probleme">
<h2><span class="section-number">4.1. </span>Position du problème<a class="headerlink" href="#position-du-probleme" title="Permalink to this headline">¶</a></h2>
<p>Nous allons chercher à résoudre numériquement l’équation d’évolution traduisant la vibration d’une molécule HCl. La différence de masse des deux atomes permet de supposer que l’atome de chlore est immobile. On travaillera donc dans son référentiel qu’on supposera galiléen. On suppose le mouvement de l’atome d’hydrogène rectiligne suivant un axe Ox (O étant la position du chlore)</p>
<p>Le système HCl est supposé isolé. On suppose que l’interaction intramoléculaire est modélisée par l’énergie potentielle :</p>
<div class="math notranslate nohighlight">
\[
E_p = {C \over r^n} - \alpha {e^2 \over 4\pi \epsilon_0 r}
\]</div>
<p>avec : <span class="math notranslate nohighlight">\(C = 2.2 \times 10^{-138} J.m^{12}; \alpha = 0.40; n = 12; \epsilon_0 = 8.85 \times 10^{-12} SI; e=1.6\times 10^{-19}C\)</span></p>
<p>et la masse de l’hydrogène : <span class="math notranslate nohighlight">\(m_H = 1.0 \times 10^{-27} kg\)</span>.</p>
<p>Pour éviter de traiter des puissances trop importantes, on va changer les unités d’étude : la <strong>masse</strong> sera en <em>unité de masse atomique</em>, les <strong>distances</strong> en <em>Angstrom</em>, les <strong>charges</strong> en nombre de fois <em>la charge élémentaire</em> et  les <strong>temps</strong> en <em>femtosecondes</em>. Les constantes précédentes prennent alors les valeurs suivantes (UA = Unité arbitraire):</p>
<p><span class="math notranslate nohighlight">\(C = 2.2 \times 10^{-1} (UA); \alpha = 0.40; n = 12; \epsilon_0 = 3.45 \times 10^{-1} (UA); e=1 (UA); m_H = 1 (UA)\)</span></p>
<div class="section" id="etude-de-l-energie-potentielle">
<h3><span class="section-number">4.1.1. </span>Etude de l’énergie potentielle.<a class="headerlink" href="#etude-de-l-energie-potentielle" title="Permalink to this headline">¶</a></h3>
<p>Vous devez :</p>
<ol class="simple">
<li><p>Ecrire une fonction <code class="docutils literal notranslate"><span class="pre">Ep</span></code> qui prend comme argument une distance <code class="docutils literal notranslate"><span class="pre">r</span></code> et qui renvoie l’énergie potentielle associée. <em>Il est conseillé d’enregistrer les variables C, alpha… comme des variables globales.</em></p></li>
<li><p>Ecrire une fonction <code class="docutils literal notranslate"><span class="pre">force</span></code> qui prend comme argument une valeur <code class="docutils literal notranslate"><span class="pre">x</span></code> et <code class="docutils literal notranslate"><span class="pre">pas</span></code> et qui renvoie la valeur de la force : <span class="math notranslate nohighlight">\(F = - \frac{dE_p}{dr}\)</span> estimée en <code class="docutils literal notranslate"><span class="pre">x</span></code> par dérivation numérique en utilisant le pas <code class="docutils literal notranslate"><span class="pre">pas</span></code>.</p></li>
<li><p>Tracer <span class="math notranslate nohighlight">\(E_p(r)\)</span>^et <span class="math notranslate nohighlight">\(F(r)\)</span> pour <span class="math notranslate nohighlight">\(r\)</span> entre 1 et 10 Angstrom.</p></li>
<li><p>Déterminer, par une recherche de 0 par dichotomie, la distance <code class="docutils literal notranslate"><span class="pre">rE</span></code> correspondant à la position d’équilibre de la molécule avec une tolérance de <span class="math notranslate nohighlight">\(10^{-14} m\)</span>.</p></li>
</ol>
<p><strong>Pensez à bien utiliser la notation scientifique 4e-12 pour entrer la valeur numérique <span class="math notranslate nohighlight">\(4\times 10^{-12}\)</span>.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">N&#39;oubliez pas les bibliothèques scientifiques </span>
<span class="sd">et pensez à commenter votre code.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="sd">&quot;&quot;&quot;Définition des constantes&quot;&quot;&quot;</span>
<span class="n">C</span> <span class="o">=</span> <span class="mf">2.2e-1</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">epsilon0</span> <span class="o">=</span> <span class="mf">3.45e-1</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">Ep</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fonction renvoyant l&#39;énergie potentielle à une distance r&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">C</span> <span class="o">/</span> <span class="n">r</span> <span class="o">**</span> <span class="n">n</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">e</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">epsilon0</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">force</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pas</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fonction qui calcul les valeurs de dérivées pour un vecteur de valeurs avec un pas de dérivation.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">-</span> <span class="p">(</span><span class="n">Ep</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">pas</span><span class="p">)</span> <span class="o">-</span> <span class="n">Ep</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">pas</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pas</span><span class="p">)</span>  <span class="c1"># On prend l&#39;opposé</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Tracé graphique</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">rpas</span> <span class="o">=</span> <span class="mf">1e-2</span>
<span class="n">rt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">rpas</span><span class="p">)</span>
<span class="n">Ept</span> <span class="o">=</span> <span class="n">Ep</span><span class="p">(</span><span class="n">rt</span><span class="p">)</span>
<span class="n">forcet</span> <span class="o">=</span> <span class="n">force</span><span class="p">(</span><span class="n">rt</span><span class="p">,</span> <span class="n">rpas</span><span class="p">)</span>

<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Profil de force et d&#39;énergie potentielle&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Energie potentielle&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;r(m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># Pour forcer les valeurs limites des abscisses</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Ep(J)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rt</span><span class="p">,</span> <span class="n">Ept</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;r(m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;F(N)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rt</span><span class="p">,</span> <span class="n">forcet</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Détermination de la position d&#39;équilibre : zéro de la force.</span>
<span class="sd">On doit choisir un pas inférieur à 10^-14 pour le calcul de la dérivée</span>
<span class="sd">Le tracé graphique montre qu&#39;on peut directement chercher entre 0 et 2e-10 m.</span>
<span class="sd">&quot;&quot;&quot;</span>    
<span class="k">def</span> <span class="nf">dicho</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">rmin</span><span class="p">,</span> <span class="n">rmax</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">pas</span><span class="p">):</span>
    <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">rmax</span> <span class="o">+</span> <span class="n">rmin</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">rmax</span> <span class="o">-</span> <span class="n">rmin</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mid</span>
    <span class="k">elif</span> <span class="n">f</span><span class="p">(</span><span class="n">mid</span><span class="p">,</span> <span class="n">pas</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mid</span>
    <span class="k">elif</span> <span class="n">f</span><span class="p">(</span><span class="n">rmin</span><span class="p">,</span> <span class="n">pas</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">mid</span><span class="p">,</span> <span class="n">pas</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dicho</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">rmin</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">pas</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">f</span><span class="p">(</span><span class="n">rmax</span><span class="p">,</span> <span class="n">pas</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">mid</span><span class="p">,</span> <span class="n">pas</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dicho</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">rmax</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">pas</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;La fonction ne s&#39;annule pas !&quot;</span><span class="p">)</span>

<span class="n">re</span> <span class="o">=</span> <span class="n">dicho</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">re</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/meca_non_lineaire_correction_3_0.png" src="_images/meca_non_lineaire_correction_3_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.356475830078125
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="schema-d-euler-pour-un-equation-d-ordre-2">
<h2><span class="section-number">4.2. </span>Schéma d’Euler pour un équation d’ordre 2<a class="headerlink" href="#schema-d-euler-pour-un-equation-d-ordre-2" title="Permalink to this headline">¶</a></h2>
<p>On rappelle le principe, on utilise deux fonctions inconnues :</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{pmatrix}
x(t)\\
v(t)
\end{pmatrix}
\end{split}\]</div>
<p>On a alors la relation :</p>
<div class="math notranslate nohighlight">
\[\begin{split}
{\rm{d} \over \rm{dt}}
\begin{pmatrix}
x(t)\\
v(t)
\end{pmatrix}
=
\begin{pmatrix}
v(t)\\
{\sum F_{ext}(t, x, v) \over m} = f(t, x, v)
\end{pmatrix}
\end{split}\]</div>
<p>On peut alors implémenter le schéma d’Euler explicite sur le vecteur précédent :</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{pmatrix}
x_{k+1}\\
v_{k+1}
\end{pmatrix}
=
\begin{pmatrix}
x_{k} + h \times v_k\\
v_k + h \times f(t, x, v)
\end{pmatrix}
\end{split}\]</div>
<p>où <span class="math notranslate nohighlight">\(h\)</span> est le pas d’intégration.</p>
<ol>
<li><p>Préciser l’expression de <span class="math notranslate nohighlight">\(f(t, x, v)\)</span> pour notre système et définir une fonction <code class="docutils literal notranslate"><span class="pre">f_euler(t,</span> <span class="pre">x,</span> <span class="pre">v)</span></code> qui renvoie cette expression.</p></li>
<li><p>Définir une fonction <code class="docutils literal notranslate"><span class="pre">euler</span></code> qui prend pour argument :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> : la fonction du schéma d’Euler</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">h</span></code> : le pas d’intégration choisi</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x0</span></code> et <code class="docutils literal notranslate"><span class="pre">v0</span></code> : les conditions initiales sur la position et la vitesse au temps initial <span class="math notranslate nohighlight">\(t=0\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tf</span></code> : le temps final pour l’intégration.</p></li>
</ul>
<p>et qui renvoie trois vecteurs :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tk</span></code> les temps où on calcule les positions vitesses</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xk</span></code> les positions <span class="math notranslate nohighlight">\(x(t_k)\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vk</span></code> les vitesses <span class="math notranslate nohighlight">\(v(t_k)\)</span></p></li>
</ul>
</li>
<li><p>Vous pouvez tester votre fonction sur une chute libre (<span class="math notranslate nohighlight">\(f(t, x, v) = g = 10\)</span>) avec un faible nombre de points.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Pensez à réutiliser les fonctions déjà définies.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">pas</span> <span class="o">=</span> <span class="mf">1e-4</span>  <span class="c1"># pas pour le calcul de la force</span>
<span class="n">lambd</span> <span class="o">=</span> <span class="mf">1e-10</span>

<span class="k">def</span> <span class="nf">f_hcl</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">force</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pas</span><span class="p">)</span> <span class="o">/</span> <span class="n">m</span> <span class="o">-</span> <span class="n">lambd</span> <span class="o">*</span> <span class="n">v</span>

<span class="k">def</span> <span class="nf">euler2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">tf</span><span class="p">):</span>
    <span class="n">tk</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># On va travailler avec des listes (taille variable). On pourrait aussi prévoir la taille du vecteur.</span>
    <span class="n">xk</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">]</span>
    <span class="n">vk</span> <span class="o">=</span> <span class="p">[</span><span class="n">v0</span><span class="p">]</span>
    <span class="k">while</span> <span class="n">tk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">tf</span><span class="p">:</span>
        <span class="n">oldv</span> <span class="o">=</span> <span class="n">vk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">oldx</span> <span class="o">=</span> <span class="n">xk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">oldt</span> <span class="o">=</span> <span class="n">tk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">oldt</span><span class="p">,</span> <span class="n">oldx</span><span class="p">,</span> <span class="n">oldv</span><span class="p">)</span>
        <span class="n">vk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oldv</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>  <span class="c1"># Ajout de la nouvelle vitesse</span>
        <span class="n">xk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oldx</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">oldv</span><span class="p">)</span>  <span class="c1"># Ajout de la nouvelle position</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oldt</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span>  <span class="c1"># Avancée d&#39;un pas de temps</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tk</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xk</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vk</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Comparaison avec un modèle connu&quot;&quot;&quot;</span>
<span class="n">g</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">def</span> <span class="nf">chute_libre</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">g</span>


<span class="n">test_e</span> <span class="o">=</span> <span class="n">euler2</span><span class="p">(</span><span class="n">chute_libre</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">xg</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">g</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">test_e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>  <span class="c1"># Valeur théorique</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>  <span class="c1"># On compare la position implémentée et la position théorique</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">test_e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Euler&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xg</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Théorie&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/meca_non_lineaire_correction_6_0.png" src="_images/meca_non_lineaire_correction_6_0.png" />
</div>
</div>
</div>
<div class="section" id="application-a-l-etude-de-la-vibration">
<h2><span class="section-number">4.3. </span>Application à l’étude de la vibration<a class="headerlink" href="#application-a-l-etude-de-la-vibration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="effets-de-non-linearite">
<h3><span class="section-number">4.3.1. </span>Effets de non linéarité<a class="headerlink" href="#effets-de-non-linearite" title="Permalink to this headline">¶</a></h3>
<p>Le but est d’observer les vibrations de la molécule autour de sa position d’équilibre pour :</p>
<ul class="simple">
<li><p>une vibration de très faible amplitude : <span class="math notranslate nohighlight">\((r - r_E) &lt; 0.01 r_E\)</span></p></li>
<li><p>une vibration plus importante : <span class="math notranslate nohighlight">\((r - r_E) &lt; 0.2 r_E\)</span></p></li>
</ul>
<p>On cherchera à observer par les tracés temporelles et le portrait de phase si l’approximation linéaire de l’équation pourrait être valable et quelle sont les effets de non linéarité.</p>
<p>Vous devez :</p>
<ol class="simple">
<li><p>Définir une fonction <code class="docutils literal notranslate"><span class="pre">Ec(v)</span></code> qui renvoient l’énergie cinétique du système pour une vitesse donnée.</p></li>
<li><p>Utiliser votre implémentation du schéma d’Euler pour obtenir les temps <span class="math notranslate nohighlight">\(t_k\)</span>, positions <span class="math notranslate nohighlight">\(x(t_k)\)</span> et vitesses <span class="math notranslate nohighlight">\(v(t_k)\)</span> pour les deux cas étudiées puis les énergies potentielles <span class="math notranslate nohighlight">\(E_p(t_k)\)</span>, énergie cinétique <span class="math notranslate nohighlight">\(E_c(t_k)\)</span> et énergie mécanique <span class="math notranslate nohighlight">\(E_m(t_k)\)</span> aux temps <span class="math notranslate nohighlight">\(t_k\)</span>.</p></li>
<li><p>Tracer alors une fenêtre avec 4 graphiques : l’un donnant <span class="math notranslate nohighlight">\(x(t)\)</span>, le second <span class="math notranslate nohighlight">\(v(t)\)</span>, le troisième le portrait de phase et le quatrième l’évolution des 3 termes énergétiques.</p></li>
<li><p>Observer l’influence du pas d’intégration et l’adapter pour une intégration correcte.</p></li>
<li><p>Observer si ces évolutions sont cohérentes avec l’approximation linéaire et sinon quelles sont les différences.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Ec</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span><span class="n">v</span> <span class="o">**</span> <span class="mi">2</span>

<span class="k">def</span> <span class="nf">Em</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Ep</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">Ec</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Test pour une faible amplitude. On part sans vitesse initiale de l&#39;amplitude donnée&quot;&quot;&quot;</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">re</span> <span class="o">+</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">re</span>

<span class="sd">&quot;&quot;&quot;Choix du temps final</span>
<span class="sd">La pulsation propre est de l&#39;ordre de 10^-14 donc on va prendre plusieurs périodes propres</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">w0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">T0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">w0</span>
<span class="n">tf</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">T0</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">tf</span> <span class="o">/</span> <span class="mf">1e5</span>  <span class="c1"># On aura donc 1000000 de points</span>

<span class="n">tfaible</span><span class="p">,</span> <span class="n">xfaible</span><span class="p">,</span> <span class="n">vfaible</span> <span class="o">=</span> <span class="n">euler2</span><span class="p">(</span><span class="n">f_hcl</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">tf</span><span class="p">)</span>
<span class="n">Ecfaible</span> <span class="o">=</span> <span class="n">Ec</span><span class="p">(</span><span class="n">vfaible</span><span class="p">)</span>
<span class="n">Epfaible</span> <span class="o">=</span> <span class="n">Ep</span><span class="p">(</span><span class="n">xfaible</span><span class="p">)</span>
<span class="n">Emfaible</span> <span class="o">=</span> <span class="n">Ecfaible</span> <span class="o">+</span> <span class="n">Epfaible</span>  <span class="c1"># Plus direct</span>

<span class="sd">&quot;&quot;&quot;Tracé graphique&quot;&quot;&quot;</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">f</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Faible oscillations&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Position&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t(s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;r(m))&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tfaible</span><span class="p">,</span> <span class="n">xfaible</span> <span class="o">-</span> <span class="n">re</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Vitesse&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t(s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;v(m/s))&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tfaible</span><span class="p">,</span> <span class="n">vfaible</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Position&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;r(m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;v(m/s))&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xfaible</span><span class="p">,</span> <span class="n">vfaible</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Position&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t(s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E(J))&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tfaible</span><span class="p">,</span> <span class="n">Ecfaible</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ec&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tfaible</span><span class="p">,</span> <span class="n">Epfaible</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ep&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tfaible</span><span class="p">,</span> <span class="n">Emfaible</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Em&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="sd">&quot;&quot;&quot;Test pour une forte amplitude. On part sans vitesse initiale de l&#39;amplitude donnée&quot;&quot;&quot;</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">re</span> <span class="o">+</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">re</span>

<span class="sd">&quot;&quot;&quot;Choix du temps final</span>
<span class="sd">La pulsation propre est de l&#39;ordre de 10^-14 donc on va prendre plusieurs périodes propres</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">w0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">T0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">w0</span>
<span class="n">tf</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">T0</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">tf</span> <span class="o">/</span> <span class="mf">1e5</span>  <span class="c1"># On aura donc 1000000 de points</span>

<span class="n">tfort</span><span class="p">,</span> <span class="n">xfort</span><span class="p">,</span> <span class="n">vfort</span> <span class="o">=</span> <span class="n">euler2</span><span class="p">(</span><span class="n">f_hcl</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">tf</span><span class="p">)</span>
<span class="n">Ecfort</span> <span class="o">=</span> <span class="n">Ec</span><span class="p">(</span><span class="n">vfort</span><span class="p">)</span>
<span class="n">Epfort</span> <span class="o">=</span> <span class="n">Ep</span><span class="p">(</span><span class="n">xfort</span><span class="p">)</span>
<span class="n">Emfort</span> <span class="o">=</span> <span class="n">Ecfort</span> <span class="o">+</span> <span class="n">Epfort</span>  <span class="c1"># Plus direct</span>

<span class="sd">&quot;&quot;&quot;Tracé graphique&quot;&quot;&quot;</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">f</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Faible oscillations&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Position&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t(fs)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;r(m))&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tfort</span><span class="p">,</span> <span class="n">xfort</span> <span class="o">-</span> <span class="n">re</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Vitesse&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t(fs)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;v(m/s))&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tfort</span><span class="p">,</span> <span class="n">vfort</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Position&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;r(m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;v(m/s))&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xfort</span><span class="p">,</span> <span class="n">vfort</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Position&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t(fs)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E(J))&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tfort</span><span class="p">,</span> <span class="n">Ecfort</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ec&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tfort</span><span class="p">,</span> <span class="n">Epfort</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ep&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tfort</span><span class="p">,</span> <span class="n">Emfort</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Em&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/meca_non_lineaire_correction_8_0.png" src="_images/meca_non_lineaire_correction_8_0.png" />
<img alt="_images/meca_non_lineaire_correction_8_1.png" src="_images/meca_non_lineaire_correction_8_1.png" />
</div>
</div>
<p><strong>Observations :</strong></p>
<ul class="simple">
<li><p>Le pas d’intégration est critique, pour un pas trop faible, l’évolution n’est pas correct, on observe notamment un dérive énergétique alors que le système est conservatif.</p></li>
<li><p>On observe un comportement proche d’un oscillateur harmonique aux faibles amplitudes et un comportement qui dévie du modèle harmonique aux fortement amplitudes.</p></li>
<li><p>On remarque que dans le cas non linéaire, l’énergie mécanique fluctue alors qu’elle devrait être constante. C’est un problème lié à l’intégration numérique. Il faudrait sans doute encore augmenter le pas (mais ça coûte beaucoup de temps). De plus le schéma d’Euler explicite pose le problème de la non conservation de l’énergie mécanique, même pour des systèmes conservatifs. Pour étudier de tels systèmes plus précisément, on utilise souvent d’autres schéma d’intégration qui ont la particularité de conserver l’énergie (<em>algorithmes symplectiques</em>)</p></li>
</ul>
</div>
<div class="section" id="fonctions-de-la-bibliotheque-scipy">
<h3><span class="section-number">4.3.2. </span>Fonctions de la bibliothéque scipy<a class="headerlink" href="#fonctions-de-la-bibliotheque-scipy" title="Permalink to this headline">¶</a></h3>
<p>Nous allons utiliser la fonction <code class="docutils literal notranslate"><span class="pre">odeint</span></code> de la bibliothèque <code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code>. Sa signature est :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">odeint</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">tfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code> : fonction qui renvoie le vecteur :</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix}
v_k\\
f(t, x, v)
\end{pmatrix}
\end{split}\]</div>
<p>Plus généralement, on utiliser la représentation matricielle :</p>
<div class="math notranslate nohighlight">
\[
\begin{pmatrix}
Y_{k+1} = Y_k + h * F(t, x, v)
\end{pmatrix}
\]</div>
<p>avec</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Y_k = \begin{pmatrix}
x_k\\
v_k
\end{pmatrix}
\end{split}\]</div>
<p>et <span class="math notranslate nohighlight">\(F\)</span> une fonction qui renvoie un vecteur (deux valeurs). Ici le vecteur donné précédemment.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">y0</span></code> est un <strong>vecteur</strong> donnant les conditions initiales.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> est le vecteur pour lequels les valeurs de <span class="math notranslate nohighlight">\(Y_k\)</span> (positions et vitesses) seront calculées. (<code class="docutils literal notranslate"><span class="pre">t</span></code> doit être ordonné).</p></li>
</ul>
<p>Elle renvoie un tableau où chaque colonne est les estimations des fonctions à intégrer (ici x et v).</p>
<p><strong>Précision sur le vecteur <code class="docutils literal notranslate"><span class="pre">t</span></code> et le pas d’intégration.</strong><br />
Vous remarquerez qu’on ne donne pas de pas d’intégration. Le vecteur <code class="docutils literal notranslate"><span class="pre">t</span></code> ne fait pas office de pas d’intégration. Les valeurs de position et vitesse à ces temps seront calculées ensuite par interpolation.</p>
<p>C’est la fonction odeint elle-même qui va déterminer le pas d’intégration par comparaison d’erreurs entre plusieurs méthodes. Elles peut fait varier ce pas d’intégration au cours du calcul : on dit que c’est une méthode à <strong>pas variable.</strong> On peut régler la tolérance sur l’erreur avec des arguments optionnels non présentés ici.</p>
<p>Ce pas pouvant varier et quelles fois être grand, il est préférable de donner explicitement un vecteur avec des valeurs temps pour calculer les positions et vitesses a posteriori.</p>
<ol class="simple">
<li><p>A vous de comprendre et utiliser la fonction précédente pour réaliser l’intégration du problème et étudier les vibration de la molécule.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_hcl2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">force</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pas</span><span class="p">)</span><span class="o">/</span> <span class="n">m</span><span class="p">]</span>

<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>

<span class="n">r0</span> <span class="o">=</span> <span class="n">re</span> <span class="o">+</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">re</span>
<span class="n">todeint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">T0</span><span class="p">,</span> <span class="n">T0</span> <span class="o">/</span> <span class="mf">1e5</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">f_hcl2</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">todeint</span><span class="p">,</span> <span class="n">tfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;yy contient deux colonnes : position et vitesse aux temps de todeint&quot;&quot;&quot;</span>
<span class="n">xodeint</span> <span class="o">=</span> <span class="n">yy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">vodeint</span> <span class="o">=</span> <span class="n">yy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">Ecodeint</span> <span class="o">=</span> <span class="n">Ec</span><span class="p">(</span><span class="n">vodeint</span><span class="p">)</span>
<span class="n">Epodeint</span> <span class="o">=</span> <span class="n">Ep</span><span class="p">(</span><span class="n">xodeint</span><span class="p">)</span>
<span class="n">Emodeint</span> <span class="o">=</span> <span class="n">Ecodeint</span> <span class="o">+</span> <span class="n">Epodeint</span>  <span class="c1"># Plus direct</span>

<span class="sd">&quot;&quot;&quot;Tracé graphique&quot;&quot;&quot;</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">f</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Faible oscillations&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Position&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t(fs)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;r(m))&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">todeint</span><span class="p">,</span> <span class="n">xodeint</span> <span class="o">-</span> <span class="n">re</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Vitesse&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t(fs)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;v(m/s))&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">todeint</span><span class="p">,</span> <span class="n">vodeint</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Position&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;r(m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;v(m/s))&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xodeint</span><span class="p">,</span> <span class="n">vodeint</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Position&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t(fs)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E(J))&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">todeint</span><span class="p">,</span> <span class="n">Ecodeint</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ec&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">todeint</span><span class="p">,</span> <span class="n">Epodeint</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ep&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">todeint</span><span class="p">,</span> <span class="n">Emodeint</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Em&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/meca_non_lineaire_correction_11_0.png" src="_images/meca_non_lineaire_correction_11_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">Ep</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.12773626487426354
</pre></div>
</div>
</div>
</div>
<p>On remarque que l’énergie potentielle pour 1 Angstrom est positive, ce qui place l’hydrogène dans un état de diffusion (Ep potentielle nulle à l’infini et pas d’autre barrière d’énergie potentielle).</p>
<p><strong>On va donc placer l’hydrogène dans un état <span class="math notranslate nohighlight">\(r0 = 1 \mathring{A}\)</span> et <span class="math notranslate nohighlight">\(v0 = 0\)</span>.</strong></p>
<p>L’énergie mécanique étant conservée et <span class="math notranslate nohighlight">\(Ep(+\infty) = 0\)</span>, <em>il vient que l’énergie cinétique finale devrait être égale à l’énergie potentielle initiale (où <span class="math notranslate nohighlight">\(Ec = 0\)</span>).</em></p>
<p>On va réaliser une intégration avec <code class="docutils literal notranslate"><span class="pre">odeint</span></code> pour bénéficier du pas qui va s’adapter à l’intégration. On va étudier le système sur un temps relativement long pour considérer qu’on est proche de l’infini et on va tracer les 4 graphiques comme précédemment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">todeint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">T0</span><span class="p">,</span> <span class="n">T0</span> <span class="o">/</span> <span class="mf">1e5</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">f_hcl2</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">todeint</span><span class="p">,</span> <span class="n">tfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;yy contient deux colonnes : position et vitesse aux temps de todeint&quot;&quot;&quot;</span>
<span class="n">xodeint</span> <span class="o">=</span> <span class="n">yy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">vodeint</span> <span class="o">=</span> <span class="n">yy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">Ecodeint</span> <span class="o">=</span> <span class="n">Ec</span><span class="p">(</span><span class="n">vodeint</span><span class="p">)</span>
<span class="n">Epodeint</span> <span class="o">=</span> <span class="n">Ep</span><span class="p">(</span><span class="n">xodeint</span><span class="p">)</span>
<span class="n">Emodeint</span> <span class="o">=</span> <span class="n">Ecodeint</span> <span class="o">+</span> <span class="n">Epodeint</span>  <span class="c1"># Plus direct</span>

<span class="sd">&quot;&quot;&quot;Tracé graphique&quot;&quot;&quot;</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">f</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Faible oscillations&quot;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Position&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t(fs)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;r(m))&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">todeint</span><span class="p">,</span> <span class="n">xodeint</span> <span class="o">-</span> <span class="n">re</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Vitesse&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t(fs)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;v(m/s))&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">todeint</span><span class="p">,</span> <span class="n">vodeint</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Position&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;r(m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;v(m/s))&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xodeint</span><span class="p">,</span> <span class="n">vodeint</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Position&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t(fs)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E(J))&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">todeint</span><span class="p">,</span> <span class="n">Ecodeint</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ec&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">todeint</span><span class="p">,</span> <span class="n">Epodeint</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ep&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">todeint</span><span class="p">,</span> <span class="n">Emodeint</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Em&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/meca_non_lineaire_correction_14_0.png" src="_images/meca_non_lineaire_correction_14_0.png" />
</div>
</div>
<p>On observe que l’énergie cinétique se rapproche bien de l’énergie mécanique comme attendu.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="elec_filtrage_correction.html" title="previous page"><span class="section-number">3. </span>Etude numérique d’un filtre linéaire</a>
    <a class='right-next' id="next-link" href="meca_pendule_correction.html" title="next page"><span class="section-number">5. </span>Etude d’un pendule simple</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By C. Lacpatia<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>